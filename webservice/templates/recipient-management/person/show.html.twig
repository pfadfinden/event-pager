{% extends 'layout.html.twig' %}

{% block title %}{% trans %}Recipient Management{% endtrans %} - {{ recipient.name }}{% endblock %}

{% block main %}
	<main class="main-container mx-auto p-4">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="{{ path('web_recipient_management_overview') }}">{% trans %}Recipients{% endtrans %}</a></li>
				<li class="breadcrumb-item active" aria-current="page">{{ recipient.name }}</li>
			</ol>
		</nav>

		<h1>
			<span class="badge badge-recipient-person me-2">
				<twig:ux:icon name="bi:person" height="20" width="20" aria-hidden="true" class="bi"/>
			</span>
			{{ recipient.name }}
		</h1>

		<div class="row gx-5">
			<div class="py-3 mt-5 col-12 col-md bg-body-secondary">
				<h3>{% trans %}Details{% endtrans %}</h3>
				<dl>
					<dt>{% trans %}Name{% endtrans %}</dt>
					<dd>{{ recipient.name }}</dd>
					<dt>{% trans %}Type{% endtrans %}</dt>
					<dd>{% trans %}Person{% endtrans %}</dd>
				</dl>
				{% if is_granted('ROLE_MANAGE_RECIPIENT_INDIVIDUALS') %}
					<a href="{{ path('web_recipient_management_person_edit', {id: recipient.id}) }}" class="btn btn-outline-primary btn-sm">
						{% trans %}Edit{% endtrans %}
					</a>
				{% endif %}
			</div>
		</div>

		{% if recipient.assignedRoles|length > 0 %}
		<div class="mt-5">
			<h3>{% trans %}Assigned Roles{% endtrans %}</h3>
			<ul class="list-group">
				{% for role in recipient.assignedRoles %}
					<li class="list-group-item d-flex justify-content-between align-items-center">
						<span>
							<twig:ux:icon name="bi:person-badge" height="16" width="16" aria-hidden="true" class="bi me-2"/>
							{{ role.name }}
						</span>
						<a href="{{ path('web_recipient_management_role_details', {id: role.id}) }}" class="btn btn-outline-primary btn-sm">
							<twig:ux:icon name="bi:eye" height="14" width="14" aria-hidden="true" class="bi"/>
						</a>
					</li>
				{% endfor %}
			</ul>
		</div>
		{% endif %}

		{% if recipient.groups|length > 0 %}
		<div class="mt-5">
			<h3>{% trans %}Member of Groups{% endtrans %}</h3>
			<ul class="list-group">
				{% for group in recipient.groups %}
					<li class="list-group-item d-flex justify-content-between align-items-center">
						<span>
							<twig:ux:icon name="bi:people" height="16" width="16" aria-hidden="true" class="bi me-2"/>
							{{ group.name }}
						</span>
						<a href="{{ path('web_recipient_management_group_details', {id: group.id}) }}" class="btn btn-outline-primary btn-sm">
							<twig:ux:icon name="bi:eye" height="14" width="14" aria-hidden="true" class="bi"/>
						</a>
					</li>
				{% endfor %}
			</ul>
		</div>
		{% endif %}

		{{ include('recipient-management/_transport/_list.html.twig', {
			recipient: recipient,
			recipientType: 'person',
			manageRole: 'ROLE_MANAGE_RECIPIENT_INDIVIDUALS'
		}) }}

		{% if is_granted('ROLE_MANAGE_RECIPIENT_INDIVIDUALS') %}
		<div class="row gx-5">
			<div class="mt-5 py-3 bg-danger text-bg-danger">
				<h3>{% trans %}Danger Zone{% endtrans %}</h3>
				<p>{% trans %}This action is destructive and cannot be undone.{% endtrans %}</p>
				{% if recipient.assignedRoles|length > 0 %}
					<p class="fw-bold">{% trans %}This person is assigned to roles and cannot be deleted.{% endtrans %}</p>
				{% else %}
					{{ form_start(delete_form) }}
					{{ form_errors(delete_form) }}
					{{ form_widget(delete_form.delete, {'attr': {'class': 'mt-3 btn btn-outline-light'}}) }}
					{{ form_end(delete_form) }}
				{% endif %}
			</div>
		</div>
		{% endif %}
	</main>
{% endblock %}
