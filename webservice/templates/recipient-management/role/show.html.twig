{% extends 'layout.html.twig' %}

{% block title %}{% trans %}Recipient Management{% endtrans %} - {{ recipient.name }}{% endblock %}

{% block main %}
	<main class="main-container mx-auto p-4">
		<nav aria-label="breadcrumb">
			<ol class="breadcrumb">
				<li class="breadcrumb-item"><a href="{{ path('web_recipient_management_overview') }}">{% trans %}Recipients{% endtrans %}</a></li>
				<li class="breadcrumb-item active" aria-current="page">{{ recipient.name }}</li>
			</ol>
		</nav>

		<h1>
			<span class="badge badge-recipient-role me-2">
				<twig:ux:icon name="bi:person-badge" height="20" width="20" aria-hidden="true" class="bi"/>
			</span>
			{{ recipient.name }}
		</h1>

		<div class="row gx-5">
			<div class="py-3 mt-5 col-12 col-md bg-body-secondary">
				<h3>{% trans %}Details{% endtrans %}</h3>
				<dl>
					<dt>{% trans %}Name{% endtrans %}</dt>
					<dd>{{ recipient.name }}</dd>
					<dt>{% trans %}Type{% endtrans %}</dt>
					<dd>{% trans %}Role{% endtrans %}</dd>
				</dl>
				{% if is_granted('ROLE_MANAGE_RECIPIENT_ROLES') %}
					<a href="{{ path('web_recipient_management_role_edit', {id: recipient.id}) }}" class="btn btn-outline-primary btn-sm">
						{% trans %}Edit{% endtrans %}
					</a>
				{% endif %}
			</div>
		</div>

		<div class="mt-5">
			<h3>{% trans %}Assigned Person{% endtrans %}</h3>
			{% if recipient.assignedPerson is not null %}
				<div class="card">
					<div class="card-body d-flex justify-content-between align-items-center">
						<span>
							<span class="badge badge-recipient-person me-2">
								<twig:ux:icon name="bi:person" height="14" width="14" aria-hidden="true" class="bi"/>
							</span>
							{{ recipient.assignedPerson.name }}
						</span>
						<div class="btn-group">
							<a href="{{ path('web_recipient_management_person_details', {id: recipient.assignedPerson.id}) }}" class="btn btn-outline-primary btn-sm" title="{{ 'View'|trans }}">
								<twig:ux:icon name="bi:eye" height="14" width="14" aria-hidden="true" class="bi"/>
							</a>
						</div>
					</div>
				</div>
				{% if unbind_person_form is not null %}
					<div class="mt-3">
						{{ form(unbind_person_form) }}
					</div>
				{% endif %}
			{% else %}
				<p class="text-muted">{% trans %}No person assigned{% endtrans %}</p>
				{% if bind_person_form is not null %}
					<div class="mt-3">
						{{ form(bind_person_form) }}
					</div>
				{% endif %}
			{% endif %}
		</div>

		{% if recipient.groups|length > 0 %}
		<div class="mt-5">
			<h3>{% trans %}Member of Groups{% endtrans %}</h3>
			<ul class="list-group">
				{% for group in recipient.groups %}
					<li class="list-group-item d-flex justify-content-between align-items-center">
						<span>
							<twig:ux:icon name="bi:people" height="16" width="16" aria-hidden="true" class="bi me-2"/>
							{{ group.name }}
						</span>
						<a href="{{ path('web_recipient_management_group_details', {id: group.id}) }}" class="btn btn-outline-primary btn-sm">
							<twig:ux:icon name="bi:eye" height="14" width="14" aria-hidden="true" class="bi"/>
						</a>
					</li>
				{% endfor %}
			</ul>
		</div>
		{% endif %}

		{{ include('recipient-management/_transport/_list.html.twig', {
			recipient: recipient,
			recipientType: 'role',
			manageRole: 'ROLE_MANAGE_RECIPIENT_ROLES'
		}) }}

		{% if is_granted('ROLE_MANAGE_RECIPIENT_ROLES') %}
		<div class="row gx-5">
			<div class="mt-5 py-3 bg-danger text-bg-danger">
				<h3>{% trans %}Danger Zone{% endtrans %}</h3>
				<p>{% trans %}This action is destructive and cannot be undone.{% endtrans %}</p>
				{{ form_start(delete_form) }}
				{{ form_errors(delete_form) }}
				{{ form_widget(delete_form.delete, {'attr': {'class': 'mt-3 btn btn-outline-light'}}) }}
				{{ form_end(delete_form) }}
			</div>
		</div>
		{% endif %}
	</main>
{% endblock %}
